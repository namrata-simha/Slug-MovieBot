{"files":[{"id":"3875704b-1771-475b-9d74-b52651d50e77","name":"Code","type":"server_js","source":"function make_a_new_quiz() {\n \n  /////////////////////////////////////////////////////////////\n  // This should be the only things you need to edit for your own use\n  /////////////////////////////////////////////////////////////\n\n  // These define the ID that you need for your own Google Drive documents. \n  // The ID is a unique identifier for each file. You can grab it from the URL\n  // for the document. For instance, if the URL reads...\n  //\n  //    https://script.google.com/a/siena.edu/d/1rACPT_W6E2u9taMKEIf2IijP6onTUtAyurojSB5di3MCd4deZsgS3KZK/edit?usp\u003ddrive_web\n  // \n  // then the ID is the string of numbers in the middle\n  //\n  //    1rACPT_W6E2u9taMKEIf2IijP6onTUtAyurojSB5di3MCd4deZsgS3KZK\n  // \n  \n  // Here is the Google Sheets that has all your questions.\n  var question_bank_ID \u003d \u00271aecjF7aD1vum9vcnj3klz0VvZlbgsg6GgWYhcU7oR0o\u0027\n  \n  // Here is the Google Sheets that you edit each time you want to select\n  // different question numbers from the question bank. \n  var questions_for_quiz_ID \u003d \u00271lAAi-KQzdvzY0kXi6iLfIEm-qzaqgWwVEw11wP_tQmw\u0027\n  \n  // Here is the Google Forms Quiz template that will get copied over each\n  // time you want to make a new quiz. \n  var quiz_template_ID \u003d \u002712X5dmJ25tjquIAJGry3GPQlKmZFEu5g_RaTv7EIlgMc\u0027\n  \n  /////////////////////////////////////////////////////////////\n  \n  ////////////////////////////////////////////////////////////\n  // First, get values from \"Create a quiz\"\n  ////////////////////////////////////////////////////////////\n\n  var sscq \u003d SpreadsheetApp.openById(questions_for_quiz_ID);\n\n  var sheetcq \u003d sscq.getSheets()[0];\n  var title \u003d sheetcq.getSheetValues(1,2,1,1)[0][0];\n  var description \u003d sheetcq.getSheetValues(2,2,1,1)[0][0];\n  var allquestions \u003d sheetcq.getSheetValues(3,2,1,100)[0];\n  \n  var questions \u003d new Array();\n  \n  for(var i\u003d0;i\u003callquestions.length;i++) {\n    if(allquestions[i]) {\n      questions.push(Math.floor(allquestions[i]));\n    }\n  }\n  \n  Logger.log(title);\n  Logger.log(description);\n  Logger.log(questions);\n\n  // OK! We got all the relevant information\n\n  ////////////////////////////////////////////////////////////  \n  // Next, make a copy of our master quiz\n  ////////////////////////////////////////////////////////////\n\n  var master_quiz \u003d DriveApp.getFileById(quiz_template_ID);\n  \n   var quiz \u003d master_quiz.makeCopy(title);\n   var id \u003d quiz.getId();\n    \n   var form \u003d FormApp.openById(id);\n    \n    form.setTitle(title)     \n     .setDescription(description)\n     .setConfirmationMessage(\u0027Thanks for responding!\u0027);\n\n\n  ////////////////////////////////////////////////////////////\n  // Let\u0027s get all the questions we want, and then add them to the \n  // new quiz!\n  ////////////////////////////////////////////////////////////\n\n  // Get the questions\n  var ss \u003d SpreadsheetApp.openById(question_bank_ID);\n  \n  var sheet \u003d ss.getSheets()[0];  \n  \n  for (var i\u003d0;i\u003cquestions.length;i++) {\n    // startRow, startColumn, numRows, numColumns\n    var text \u003d sheet.getSheetValues(questions[i]+1, 2, 1, 1)[0][0];\n    var qtype \u003d sheet.getSheetValues(questions[i]+1, 3, 1, 1)[0][0];\n    var desc \u003d sheet.getSheetValues(questions[i]+1, 4, 1, 1)[0][0];\n    var options \u003d sheet.getSheetValues(questions[i]+1, 5, 1, 3)[0];\n    \n    Logger.log(text);\n\n    if(qtype\u003d\u003d\u0027MC\u0027){ // Multiple choice\n      form.addMultipleChoiceItem()\n      .setTitle(text)\n      .setHelpText(desc)\n      .setChoiceValues(options)\n    }\n    else if(qtype\u003d\u003d\u0027CB\u0027){ // Checkbox\n      var item \u003d form.addCheckboxItem()\n      .setTitle(text)\n      .setHelpText(desc)\n      .setChoiceValues(options);\n    }\n    else if(qtype\u003d\u003d\u0027IU\u0027){ // Image by URL\n      var img \u003d UrlFetchApp.fetch(text);\n      var item \u003d form.addImageItem()\n      .setTitle(desc)\n      .setHelpText(desc)\n      .setImage(img)\n      .setWidth(300); // Hard code the image width for now. \n    }\n    else if(qtype\u003d\u003d\u0027ID\u0027){ // Image from Drive, looking for ID\n      var img \u003d DriveApp.getFileById(text).getBlob();\n      Logger.log(text);\n      Logger.log(img);\n      var item \u003d form.addImageItem()\n      .setTitle(desc)\n      .setHelpText(desc)\n      .setImage(img)\n      .setWidth(300); // Hard code the image width for now. \n    }\n    \n    \n  }\n}\n"}]}